var PjaxDefaultOption=function(){this.timeout=650,this.push=!0,this.replace=!1,this.type="GET",this.dataType="html",this.scrollTo=0,this.maxCacheLength=20},Pjax=(()=>{function r(t){this.initialURL=window.location.href,this.initialState=window.history.state,this.initialPop=!("state"in window.history),this.cacheMapping={},this.cacheForwardStack=[],this.cacheBackStack=[],this.options=$.extend({},new PjaxDefaultOption,t),this.initialState&&this.initialState.container&&(this.state=this.initialState),this.bindEvent()}return r.bind=function(t,e,n,i){return"object"==typeof e&&(i=e,e=void 0),"string"==typeof n&&(i=this.optionsFor(n,i)),t.on("click.pjax",e,function(t){var e,n=$(this);"_blank"!==n.attr("target")&&((e=i).container||((e=$.extend({},i)).container=n.attr("data-pjax")),r.instance.handleClick(t,e))})},r.load=function(t,e){e.context=t,r.instance.get(e)},r.prototype.bindEvent=function(){$(window).on("popstate.pjax",this.onPopstate.bind(this))},r.prototype.handleClick=function(t,e,n){n=r.optionsFor(e,n);var i,e=t.currentTarget,a=$(e);if("A"!==(null==(i=e.tagName)?void 0:i.toUpperCase()))throw"$.fn.pjax or $.pjax.click requires an anchor element";1<t.which||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||location.protocol!==e.protocol||location.hostname!==e.hostname||-1<e.href.indexOf("#")&&this.stripHash(e)==this.stripHash(location)||t.isDefaultPrevented()||(i={url:e.href,container:a.attr("data-pjax"),target:e},e=$.extend({},i,n),i=$.Event("pjax:click"),a.trigger(i,[e]),i.isDefaultPrevented())||(this.get(e),t.preventDefault(),a.trigger("pjax:clicked",[e]))},r.prototype.handleSubmit=function(t,e,n){n=r.optionsFor(e,n);var e=t.currentTarget,i=$(e);if("FORM"!==(null==(a=e.tagName)?void 0:a.toUpperCase()))throw"$.pjax.submit requires a form element";var a={type:(i.attr("method")||"GET").toUpperCase(),url:i.attr("action"),container:i.attr("data-pjax"),target:e};if("GET"!==a.type&&void 0!==window.FormData)a.data=new FormData(e),a.processData=!1,a.contentType=!1;else{if(i.find(":file").length)return;a.data=i.serializeArray()}this.get($.extend({},a,n)),t.preventDefault()},r.prototype.reload=function(t,e){var n={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return this.get($.extend(n,r.optionsFor(t,e)))},r.prototype.get=function(s){var p=this,l=("function"==typeof(s=$.extend(!0,{},this.options,s)).url&&(s.url=s.url()),this.parseURL(s.url).hash);if(!s.context){var t=typeof s.container;if("string"!=t)throw'expected string value for "container" option; got '+t;s.context=$(s.container)}var h=s.context;if(!h.length)throw'the container selector "'+s.container+'" did not match anything';s.data||(s.data={}),s.data instanceof Array?s.data.push({name:"_pjax",value:s.container}):s.data._pjax=s.container;function u(t,e,n){return(n=n||{}).relatedTarget=p.options.target,t=$.Event(t,n),h.trigger(t,e),!t.isDefaultPrevented()}this.state||(this.state={id:this.uniqueId(),url:window.location.href,title:document.title,container:s.container,fragment:s.fragment,timeout:s.timeout},window.history.replaceState(this.state,document.title)),this.abortXHR(this.xhr);t=this.xhr=$.ajax({method:s.type,url:s.url,data:s.data,timeout:s.timeout,processData:s.processData,dataType:s.dataType,contentType:s.contentType,beforeSend:function(t,e){if("GET"!==e.type&&(e.timeout=0),t.setRequestHeader("X-PJAX","true"),t.setRequestHeader("X-PJAX-Container",s.container),!u("pjax:beforeSend",[t,e]))return!1;0<e.timeout&&(p.timeoutTimer=setTimeout(function(){u("pjax:timeout",[t,s])&&t.abort("timeout")},e.timeout),e.timeout=0);e=p.parseURL(e.url);l&&(e.hash=l),s.requestUrl=p.stripInternalParams(e)},complete:function(t,e){p.timeoutTimer&&clearTimeout(p.timeoutTimer),u("pjax:complete",[t,e,s]),u("pjax:end",[t,s])},error:function(t,e,n){var i=p.extractContainer("",t,s),t=u("pjax:error",[t,e,n,s]);"GET"==s.type&&"abort"!==e&&t&&p.locationReplace(i.url)},success:function(t,e,n){var i=p.state,a=p.findVersion(),r=n.getResponseHeader("X-PJAX-Version"),o=p.extractContainer(t,n,s),c=p.parseURL(o.url);if(l&&(c.hash=l,o.url=c.href),a&&r&&a!==r)p.locationReplace(o.url);else if(o.contents){if(p.state={id:s.id||p.uniqueId(),url:o.url,title:o.title,container:s.container,fragment:s.fragment,timeout:s.timeout},(s.push||s.replace)&&window.history.replaceState(p.state,o.title,o.url),$.contains(h,document.activeElement))try{document.activeElement.blur()}catch(t){}o.title&&(document.title=o.title),u("pjax:beforeReplace",[o.contents,s],{state:p.state,previousState:i}),h.html(o.contents);c=h.find("input[autofocus], textarea[autofocus]").last()[0],a=(c&&document.activeElement!==c&&c.focus(),p.executeScriptTags(o.scripts),s.scrollTo);"number"==typeof(a=l&&(r=decodeURIComponent(l.slice(1)),i=document.getElementById(r)||document.getElementsByName(r)[0])?$(i).offset().top:a)&&$(window).scrollTop(a),u("pjax:success",[t,e,n,s])}else p.locationReplace(o.url)}});return 0<t.readyState&&(s.push&&!s.replace&&(this.cachePush(this.state.id,[s.container,this.cloneContents(h)]),window.history.pushState(null,"",s.requestUrl)),u("pjax:start",[t,s]),u("pjax:send",[t,s])),t},r.prototype.locationReplace=function(t){window.history.replaceState(null,"",this.state.url),window.location.replace(t)},r.prototype.onPopstate=function(t){this.initialPop||this.abortXHR(this.xhr);var e=this.state,t=t.originalEvent.state;if(t&&t.container){if(this.initialPop&&this.initialURL==t.url)return;if(e){if(e.id===t.id)return;n=e.id<t.id?"forward":"back"}var n,i=this.cacheMapping[t.id]||[],a=i[0]||t.container,r=$(a),i=i[1];r.length?(e&&this.cachePop(n,e.id,[a,this.cloneContents(r)]),n=$.Event("pjax:popstate",{state:t,direction:n}),r.trigger(n),n={id:t.id,url:t.url,container:a,push:!1,fragment:t.fragment,timeout:t.timeout,scrollTo:!1},i?(r.trigger("pjax:start",[null,n]),(this.state=t).title&&(document.title=t.title),a=$.Event("pjax:beforeReplace",{state:t,previousState:e}),r.trigger(a,[i,n]),r.html(i),r.trigger("pjax:end",[null,n])):this.get(n),r[0].offsetHeight):this.locationReplace(location.href)}this.initialPop=!1},r.prototype.fallback=function(t){var e="function"==typeof t.url?t.url():t.url,n=t.type?t.type.toUpperCase():"GET",i=$("<form>",{method:"GET"===n?"GET":"POST",action:e,style:"display:none"}),a=("GET"!==n&&"POST"!==n&&i.append($("<input>",{type:"hidden",name:"_method",value:n.toLowerCase()})),t.data);if("string"==typeof a)$.each(a.split("&"),function(t,e){e=e.split("=");i.append($("<input>",{type:"hidden",name:e[0],value:e[1]}))});else if(a instanceof Array)$.each(a,function(t,e){i.append($("<input>",{type:"hidden",name:e.name,value:e.value}))});else if("object"==typeof a)for(var r in a)i.append($("<input>",{type:"hidden",name:r,value:a[r]}));$(document.body).append(i),i.trigger("submit")},r.prototype.abortXHR=function(t){t&&t.readyState<4&&(t.onreadystatechange=$.noop,t.abort())},r.prototype.uniqueId=function(){return(new Date).getTime()},r.prototype.cloneContents=function(t){t=t.clone();return t.find("script").each(function(){this.src||$.data(this,"globalEval",!1)}),t.contents()},r.prototype.stripInternalParams=function(t){return t.search=t.search.replace(/([?&])(_pjax|_)=[^&]*/g,"").replace(/^&/,""),t.href.replace(/\?($|#)/,"$1")},r.prototype.parseURL=function(t){var e=document.createElement("a");return e.href=t,e},r.prototype.stripHash=function(t){return t.href.replace(/#.*/,"")},r.optionsFor=function(t,e){return t&&e?((e=$.extend({},e)).container=t,e):$.isPlainObject(t)?t:{container:t}},r.prototype.findAll=function(t,e){return t.filter(e).add(t.find(e))},r.prototype.parseHTML=function(t){return $.parseHTML(t,document,!0)},r.prototype.extractContainer=function(t,e,n){var i,a={},r=/<html/i.test(t),e=e.getResponseHeader("X-PJAX-URL");return a.url=e?this.stripInternalParams(this.parseURL(e)):n.requestUrl,e=r?(i=$(this.parseHTML(t.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0])),null!=(e=t.match(/<head[^>]*>([\s\S.]*)<\/head>/i))?$(this.parseHTML(e[0])):i):i=$(this.parseHTML(t)),0!==i.length&&(a.title=this.findAll(e,"title").last().text(),n.fragment?(t=i,(t="body"!==n.fragment?this.findAll(t,n.fragment).first():t).length&&(a.contents="body"===n.fragment?t:t.contents(),a.title||(a.title=t.attr("title")||t.data("title")))):r||(a.contents=i),a.contents&&(a.contents=a.contents.not(function(){return $(this).is("title")}),a.contents.find("title").remove(),a.scripts=this.findAll(a.contents,"script[src]").remove(),a.contents=a.contents.not(a.scripts)),a.title)&&(a.title=a.title.trim()),a},r.prototype.executeScriptTags=function(t){var i;t&&(i=$("script[src]"),t.each(function(){var t,e,n=this.src;i.filter(function(){return this.src===n}).length||(t=document.createElement("script"),(e=$(this).attr("type"))&&(t.type=e),t.src=$(this).attr("src"),document.head.appendChild(t))}))},r.prototype.cachePush=function(t,e){this.cacheMapping[t]=e,this.cacheBackStack.push(t),this.trimCacheStack(this.cacheForwardStack,0),this.trimCacheStack(this.cacheBackStack,this.options.maxCacheLength)},r.prototype.cachePop=function(t,e,n){var i;this.cacheMapping[e]=n,n="forward"===t?(i=this.cacheBackStack,this.cacheForwardStack):(i=this.cacheForwardStack,this.cacheBackStack),i.push(e),(e=n.pop())&&delete this.cacheMapping[e],this.trimCacheStack(i,this.options.maxCacheLength)},r.prototype.trimCacheStack=function(t,e){for(;t.length>e;)delete this.cacheMapping[t.shift()]},r.prototype.findVersion=function(){return $("meta").filter(function(){var t=$(this).attr("http-equiv");return t&&"X-PJAX-VERSION"===t.toUpperCase()}).attr("content")},r.instance=new r,r})();(t=>{t.fn.pjax=function(t,e,n){return Pjax.bind(this,t,e,n)},t.pjax=function(t){return Pjax.instance.get(t)}})(jQuery);