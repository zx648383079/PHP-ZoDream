function bindMultipleTable(e){function i(e){var t=e.find(".page-multiple-count"),e=e.find(".page-multiple-td .checkbox.checked"),t=(t.text(e.length),t.closest("a")),a=[];e.each(function(){a.push($(this).parent().data("id"))}),t.attr("href",t.attr("href").replace(/id=[\d,]*/,"id="+a.join(","))),t.data("tip","确定要删除选中的 ".concat(e.length," 条数据？"))}e.on("click",".page-multiple-table .page-multiple-toggle",function(e){e.preventDefault(),$(this).closest(".page-multiple-table").toggleClass("page-multiple-enable")}).on("click",".page-multiple-table .page-multiple-td .checkbox",function(){var e,t=$(this),a=t.closest(".page-multiple-table"),l=!t.hasClass("checked");t.toggleClass("checked",l),l?(e=!0,a.find(".page-multiple-td .checkbox").each(function(){$(this).hasClass("checked")||(e=!1)}),e&&a.find(".page-multiple-th .checkbox").addClass("checked")):a.find(".page-multiple-th .checkbox").removeClass("checked"),i(a)}).on("click",".page-multiple-table .page-multiple-th .checkbox",function(){var e=$(this),t=e.closest(".page-multiple-table"),e=!e.hasClass("checked");t.find(".page-multiple-th .checkbox").toggleClass("checked",e),t.find(".page-multiple-td .checkbox").toggleClass("checked",e),i(t)})}function bindNavBar(e){e.on("click",".sidebar-container .sidebar-container-toggle,.app-header-container .sidebar-container-toggle,.app-wrapper .app-mask",function(){var e=$(this).closest(".app-wrapper").toggleClass("wrapper-min");e.find("ul").height()<$(window).height()-100&&e.toggleClass("sidebar-fixed",e.hasClass("wrapper-min")),$(window).trigger("resize")}).on("click",".sidebar-container li a",function(){var e=$(this),t=e.closest("li");0<t.find("ul").length?t.toggleClass("expand"):($(".sidebar-container li").removeClass("active"),t.addClass("active"),e.closest(".app-wrapper").removeClass("wrapper-min"))})}$(function(){var e=$(document).on("click",".tab-box .tab-header .fa-close",function(){var e=$(this).parent();e.closest(".tab-box").find(".tab-body .tab-item").eq(e.index()).remove(),e.remove()}).on("click",".table-toggle tr",function(){var e=$(this);e.hasClass("tr-child")||e.next(".tr-child").toggle()}).on("click","a[data-type=del]",function(e){e.preventDefault();var t,e=$(this).data("tip")||"确定删除这条数据？";confirm(e)&&(t=Dialog.loading(),postJson($(this).attr("href"),function(e){t.close(),200!=e.code||e.msg||(e.msg="删除成功！"),parseAjax(e)}))}).on("click","a[data-type=toggle]",function(e){e.preventDefault(),$(this).toggleClass("toggled"),postJson($(this).attr("href"),function(e){parseAjax(e)})}).on("click","a[data-type=form]",function(e){e.preventDefault();var e=$(this);Dialog.box({url:e.attr("href"),title:null!=(e=e.data("title"))?e:"快速编辑",ondone:function(){var t=this,e=this.find("form");ajaxForm(e.attr("action"),e.serialize(),function(e){200===e.code&&t.close(),parseAjax(e)})}})}).on("click",".tree-table .tree-item-arrow",function(e){e.preventDefault();for(var e=$(this).closest(".tree-item"),t=toInt(e.data("level")),a=!e.hasClass("tree-item-open"),l=(e.toggleClass("tree-item-open",a),e.next(".tree-item"));l&&0<l.length;){var i=toInt(l.data("level"));if(i<=t)return;l.toggleClass("tree-level-open",a&&i===t+1),l=l.next(".tree-item")}}).on("click",".page-tooltip-bar .tooltip-toggle",function(){$(this).closest(".page-tooltip-bar").toggleClass("tooltip-min")}).on("click",".plus-table tbody .fa-times",function(){var e=$(this);1!==e.closest(".plus-table").find("tbody tr").length&&e.closest("tr").remove()}).on("click",".plus-table tfoot .fa-plus",function(){var e=$(this).closest(".plus-table"),t=e.find("tbody tr").eq(0).clone(!0,!0);e.find("tbody").append(t),t.find(".form-control").val("")}).on("click",".tab-header-bar .tab-item .fa-times",function(e){e.preventDefault(),$(this).closest(".tab-item").remove()}).on("click","form *[type=submit]",function(e){var t,a=$(this).closest("form");0!==a.find(".tab-body").length&&(t=!0,a.find("*[required]").each(function(){var e;!t||(e=$(this)).val()||(e.closest(".tab-item").trigger("tab:toggle"),Dialog.tip("表单未填写完整"),t=!1)}))}).on("form:invalid","form",function(e,t){var a=$(this),t=Object.keys(t)[0],l=a.find("*[name=".concat(t,"]"));0!==(l=0===l.length?a.find("*[for=".concat(t,"]")):l).length&&(l.closest(".tab-item").trigger("tab:toggle"),l.trigger("focus"))});bindMultipleTable(e),bindNavBar(e)});