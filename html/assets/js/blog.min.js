function formData(o){var t=[];return o.find("input,textarea,select").each(function(){this.type&&0<=["radio","checkbox"].indexOf(this.type)&&!this.checked||t.push(encodeURIComponent(this.name)+"="+encodeURIComponent($(this).val().toString()))}),t.join("&")}function bindBlogPage(){$(".book-nav").on("click",function(){$(this).toggleClass("hover")}),$(".book-search").on("focus",function(){$(this).addClass("focus")}).on("blur",function(){$(this).removeClass("focus")}),$(".book-search .fa-search").on("click",function(){var o=$(".book-search");o.hasClass("focus")?$(".book-search form").submit():o.addClass("focus")}),$(".book-navicon").on("click",function(){$(".book-skin").toggleClass("book-collapsed")}),$(".book-search [name=keywords]").on("keypress",function(){var o=$(this).val();o&&$.getJSON(BASE_URI+"home/suggest?keywords="+o,function(o){var e;200==o.code&&(e="",$.each(o.data,function(o,t){e+='<li><a href="'+t.url+'">'+t.title+"</li>"}),$(".book-search .search-tip").html(e))})})}function bindBlog(o,t,e){void 0===e&&(e={}),bindLoadImg();var n=$(".book-dynamic"),i=($.get(BASE_URI+"log",{blog:o},function(o){n.html(o)}),$.getJSON(BASE_URI+"counter",{blog:o},function(o){200==o.code&&($(".book-body .tools .comment b").text(o.data.comment_count),$(".book-body .tools .click b").text(o.data.click_count),$(".book-body .tools .recommend-blog b").text(o.data.recommend_count))}),$(".book-footer")),a=(0<i.length&&$.get(BASE_URI+"comment",{blog_id:o},function(o){i.html(o)}),$(".book-body .toggle-open").on("click",function(){$(this).closest(".book-body").toggleClass("open"),l()}).on("click","a",function(o){o.stopPropagation()}),$(".rule-box button").on("click",function(){var o=$(this);$.post(o.data("url"),formData(o.closest(".rule-box")),function(o){200!=o.code?alert(o.message):(alert(o.message),setTimeout(function(){o.data.refresh?window.location.reload():o.data.url&&(window.location.href=o.data.url)},500))},"json")}),$(".recommend-blog").on("click",function(){var t=$(this).find("b");$.getJSON(BASE_URI+"recommend",{id:o},function(o){200==o.code?t.text(o.data):parseAjax(o)})}),$(".book-skin")),c=($(".book-navicon").on("click",function(){a.toggleClass("book-collapsed")}),$("#content").sideNav({target:".book-side-nav",contentLength:20,maxLength:8,title:e.side_title,maxFixedTop:function(o,t){var e=i.length<1?a.offset().top+a.height():i.offset().top,e=t+$(window).height()-o.height()<e;return e?((t=n.offset().top+n.height()-t)<=0?t=0:t+=20,o.css("top",t+"px")):o.css("top","auto"),e}})),l=function(){c.headers.length<1||c.box.toggle(s.hasClass("open")&&767<$(window).width())},s=$(".book-body");l(),$(window).on("resize",function(){l()}),bindCopy()}function bindLoadImg(){$("img.lazy").lazyload({callback:"img"});var o,e=$("#content img");e.length<1||(o=Dialog.create({type:"image",onrequest:function(o){var o=e.eq(o),t=o.data("src");return t||o.attr("src")}}),e.on("click",function(){o.showIndex(e.index(this))}))}function bindCopy(){$(document).on("click",".code-container .code-header *[data-action=copy]",function(o){o.preventDefault();o=$(this).closest(".code-container").find("code");navigator.clipboard.writeText(o.text()).then(function(){Dialog.tip("Copy successfully")},function(){Dialog.tip("Copy failed")})}).on("click",".code-container .code-header *[data-action=full]",function(o){o.preventDefault(),$(this).closest(".code-container").toggleClass("code-full-screen").removeClass("code-with-minimize")}).on("click",".code-container .code-header *[data-action=minimize]",function(o){o.preventDefault(),$(this).closest(".code-container").toggleClass("code-with-minimize").removeClass("code-full-screen")})}function bindBlogComment(o,e){void 0===e&&(e={});function t(t,e){void 0===e&&(e=a),$.get(BASE_URI+"comment/more",{blog_id:o,page:t,order:c?"desc":"asc"},function(o){t<2?e.html(o):e.append(o)})}var n,i,a=$("#comment-box"),c=!0,l=($(".comment-item .expand").on("click",function(){$(this).parent().parent().toggleClass("active")}),$(".book-comments").on("click","*[data-type=reply]",function(){var o=$(this),t=$(".book-comment-form");o.parent().append(t),t.find(".title").text(e.reply_title),t.find(".btn-submit").text(e.reply_btn),t.find("input[name=parent_id]").val(o.parents(".comment-item").attr("data-id"))}).on("click",".order span",function(){var o=$(this);o.hasClass("active")||(o.addClass("active").siblings().removeClass("active"),c=o.index()<1,t(1))}).on("click",".actions .agree",function(){var t=$(this),o=t.closest(".comment-item").data("id");$.getJSON(BASE_URI+"comment/agree",{id:o},function(o){302==o.code?window.location.href=o.url:200!=o.code?alert(o.message):t.find("b").text(o.data)})}).on("click",".actions .disagree",function(){var t=$(this),o=t.closest(".comment-item").data("id");$.getJSON(BASE_URI+"comment/disagree",{id:o},function(o){302==o.code?window.location.href=o.url:200!=o.code?alert(o.message):t.find("b").text(o.data)})})),s=$(".book-comment-form").on("click",".btn-cancel",function(){var o=$(".hot-comments");0<o.length?o.after(s):l.before(s),s.find("textarea").val(""),s.find(".title").text(e.comment_title),s.find(".btn-submit").text(e.comment_btn),s.find("input[name=parent_id]").val(0)}).on("change","input[name=email]",function(){var t,o=this.value;!o||(t=s.find("input[name=url]")).val()||postJson(BASE_URI+"comment/commentator",{email:o},function(o){200===o.code&&(t.val(o.data.url),s.find("input[name=name]").val(o.data.name))})});0<s.length&&0!==(i=s.find("input[name=email]")).length&&(n=localStorage.getItem("b_cs"))&&(n=JSON.parse(n),i.val(n.e),s.find("input[name=name]").val(n.n),s.find("input[name=url]").val(n.l)),$("#comment-form").on("submit",function(){var e=$(this);return $.post(e.attr("action"),e.serialize(),function(o){var t;200==o.code&&(0!==(t=s.find("input[name=email]")).length&&localStorage.setItem("b_cs",JSON.stringify({e:t.val(),n:s.find("input[name=name]").val(),l:s.find("input[name=url]").val()})),e.find(".btn-cancel").trigger("click")),alert(o.message)},"json"),!1}),a.on("click",".load-more",function(){var o=$(this);t(o.data("page")),o.remove()}),t(1)}$(function(){});